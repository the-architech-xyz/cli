/**
 * Security Settings Component (Tamagui)
 * 
 * User security settings with i18n support
 */

import React, { useState } from 'react';
import { YStack, XStack, Card, Text, Button, Input, Label, Switch, Separator } from 'tamagui';
import { useTranslation } from '@/lib/i18n';
import { 
  Shield, 
  Key, 
  Smartphone, 
  Mail 
} from '@tamagui/lucide-icons';

export function SecuritySettings() {
  const { t } = useTranslation();
  const [twoFactorEnabled, setTwoFactorEnabled] = useState(false);
  const [emailNotifications, setEmailNotifications] = useState(true);
  const [currentPassword, setCurrentPassword] = useState('');
  const [newPassword, setNewPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');

  const handlePasswordChange = (e: React.FormEvent) => {
    e.preventDefault();
    // Handle password change logic
  };

  return (
    <YStack gap="$6">
      {/* Header */}
      <YStack>
        <Text fontSize="$7" fontWeight="bold" color="$color">
          {t('security.title')}
        </Text>
        <Text fontSize="$4" color="$colorFocus">
          {t('security.description')}
        </Text>
      </YStack>

      <YStack gap="$6">
        {/* Password Section */}
        <Card
          theme="base"
          size="$4"
          padding="$0"
          backgroundColor="$background"
          borderWidth={1}
          borderColor="$borderColor"
          borderRadius="$6"
          elevation="$2"
        >
          <YStack padding="$6" paddingBottom="$2">
            <XStack gap="$2" alignItems="center">
              <Key size="$1" color="$color" />
              <Text fontSize="$5" fontWeight="bold" color="$color">
                {t('security.password.title')}
              </Text>
            </XStack>
            <Text fontSize="$3" color="$colorFocus">
              {t('security.password.description')}
            </Text>
          </YStack>
          
          <YStack padding="$6" paddingTop="$0">
            <YStack asChild gap="$4">
              <form onSubmit={handlePasswordChange}>
                <YStack gap="$2">
                  <Label htmlFor="current-password" fontSize="$4" color="$color">
                    {t('security.password.current')}
                  </Label>
                  <Input
                    id="current-password"
                    secureTextEntry
                    value={currentPassword}
                    onChangeText={setCurrentPassword}
                    placeholder={t('security.password.currentPlaceholder')}
                    backgroundColor="$background"
                    color="$color"
                    borderWidth={1}
                    borderColor="$borderColor"
                    borderRadius="$4"
                    padding="$3"
                  />
                </YStack>
                
                <YStack gap="$2">
                  <Label htmlFor="new-password" fontSize="$4" color="$color">
                    {t('security.password.new')}
                  </Label>
                  <Input
                    id="new-password"
                    secureTextEntry
                    value={newPassword}
                    onChangeText={setNewPassword}
                    placeholder={t('security.password.newPlaceholder')}
                    backgroundColor="$background"
                    color="$color"
                    borderWidth={1}
                    borderColor="$borderColor"
                    borderRadius="$4"
                    padding="$3"
                  />
                </YStack>
                
                <YStack gap="$2">
                  <Label htmlFor="confirm-password" fontSize="$4" color="$color">
                    {t('security.password.confirm')}
                  </Label>
                  <Input
                    id="confirm-password"
                    secureTextEntry
                    value={confirmPassword}
                    onChangeText={setConfirmPassword}
                    placeholder={t('security.password.confirmPlaceholder')}
                    backgroundColor="$background"
                    color="$color"
                    borderWidth={1}
                    borderColor="$borderColor"
                    borderRadius="$4"
                    padding="$3"
                  />
                </YStack>
                
                <Button
                  theme="accent"
                  size="$4"
                  backgroundColor="$blue10"
                  color="white"
                  borderRadius="$4"
                  onPress={handlePasswordChange}
                  alignSelf="flex-start"
                >
                  <Text fontSize="$4" fontWeight="bold">
                    {t('security.password.update')}
                  </Text>
                </Button>
              </form>
            </YStack>
          </YStack>
        </Card>

        {/* Two-Factor Authentication */}
        <Card
          theme="base"
          size="$4"
          padding="$0"
          backgroundColor="$background"
          borderWidth={1}
          borderColor="$borderColor"
          borderRadius="$6"
          elevation="$2"
        >
          <YStack padding="$6" paddingBottom="$2">
            <XStack gap="$2" alignItems="center">
              <Smartphone size="$1" color="$color" />
              <Text fontSize="$5" fontWeight="bold" color="$color">
                {t('security.twoFactor.title')}
              </Text>
            </XStack>
            <Text fontSize="$3" color="$colorFocus">
              {t('security.twoFactor.description')}
            </Text>
          </YStack>
          
          <YStack padding="$6" paddingTop="$0" gap="$4">
            <XStack justifyContent="space-between" alignItems="center">
              <YStack gap="$1">
                <Text fontSize="$4" fontWeight="medium" color="$color">
                  {t('security.twoFactor.enable')}
                </Text>
                <Text fontSize="$3" color="$colorFocus">
                  {t('security.twoFactor.enableDescription')}
                </Text>
              </YStack>
              <Switch
                checked={twoFactorEnabled}
                onCheckedChange={setTwoFactorEnabled}
                backgroundColor={twoFactorEnabled ? "$blue10" : undefined}
              />
            </XStack>
            
            {twoFactorEnabled && (
              <YStack
                backgroundColor="$gray2"
                borderWidth={1}
                borderColor="$gray6"
                borderRadius="$4"
                padding="$4"
                gap="$2"
              >
                <Text fontSize="$3" color="$colorFocus">
                  {t('security.twoFactor.qrCodeInstructions')}
                </Text>
                <XStack
                  width="$10"
                  height="$10"
                  backgroundColor="white"
                  borderWidth={1}
                  borderColor="$gray6"
                  borderRadius="$2"
                  alignItems="center"
                  justifyContent="center"
                >
                  <Text fontSize="$2" color="$colorFocus">
                    {t('security.twoFactor.qrCode')}
                  </Text>
                </XStack>
              </YStack>
            )}
          </YStack>
        </Card>

        {/* Email Notifications */}
        <Card
          theme="base"
          size="$4"
          padding="$0"
          backgroundColor="$background"
          borderWidth={1}
          borderColor="$borderColor"
          borderRadius="$6"
          elevation="$2"
        >
          <YStack padding="$6" paddingBottom="$2">
            <XStack gap="$2" alignItems="center">
              <Mail size="$1" color="$color" />
              <Text fontSize="$5" fontWeight="bold" color="$color">
                {t('security.email.title')}
              </Text>
            </XStack>
            <Text fontSize="$3" color="$colorFocus">
              {t('security.email.description')}
            </Text>
          </YStack>
          
          <YStack padding="$6" paddingTop="$0" gap="$4">
            <XStack justifyContent="space-between" alignItems="center">
              <YStack gap="$1">
                <Text fontSize="$4" fontWeight="medium" color="$color">
                  {t('security.email.alerts')}
                </Text>
                <Text fontSize="$3" color="$colorFocus">
                  {t('security.email.alertsDescription')}
                </Text>
              </YStack>
              <Switch
                checked={emailNotifications}
                onCheckedChange={setEmailNotifications}
                backgroundColor={emailNotifications ? "$blue10" : undefined}
              />
            </XStack>
            
            <Separator borderColor="$borderColor" />
            
            <XStack justifyContent="space-between" alignItems="center">
              <YStack gap="$1">
                <Text fontSize="$4" fontWeight="medium" color="$color">
                  {t('security.email.login')}
                </Text>
                <Text fontSize="$3" color="$colorFocus">
                  {t('security.email.loginDescription')}
                </Text>
              </YStack>
              <Switch
                checked={emailNotifications}
                onCheckedChange={setEmailNotifications}
                backgroundColor={emailNotifications ? "$blue10" : undefined}
              />
            </XStack>
          </YStack>
        </Card>

        {/* Security Overview */}
        <Card
          theme="base"
          size="$4"
          padding="$0"
          backgroundColor="$background"
          borderWidth={1}
          borderColor="$borderColor"
          borderRadius="$6"
          elevation="$2"
        >
          <YStack padding="$6" paddingBottom="$2">
            <XStack gap="$2" alignItems="center">
              <Shield size="$1" color="$color" />
              <Text fontSize="$5" fontWeight="bold" color="$color">
                {t('security.overview.title')}
              </Text>
            </XStack>
            <Text fontSize="$3" color="$colorFocus">
              {t('security.overview.description')}
            </Text>
          </YStack>
          
          <YStack padding="$6" paddingTop="$0" gap="$4">
            <XStack justifyContent="space-between" alignItems="center">
              <Text fontSize="$4" fontWeight="medium" color="$color">
                {t('security.overview.passwordStrength')}
              </Text>
              <Text fontSize="$4" color="$green10" fontWeight="medium">
                {t('security.overview.strong')}
              </Text>
            </XStack>
            
            <XStack justifyContent="space-between" alignItems="center">
              <Text fontSize="$4" fontWeight="medium" color="$color">
                {t('security.overview.twoFactor')}
              </Text>
              <Text 
                fontSize="$4" 
                color={twoFactorEnabled ? "$green10" : "$red10"} 
                fontWeight="medium"
              >
                {twoFactorEnabled 
                  ? t('security.overview.enabled') 
                  : t('security.overview.disabled')
                }
              </Text>
            </XStack>
            
            <XStack justifyContent="space-between" alignItems="center">
              <Text fontSize="$4" fontWeight="medium" color="$color">
                {t('security.overview.emailVerification')}
              </Text>
              <Text fontSize="$4" color="$green10" fontWeight="medium">
                {t('security.overview.verified')}
              </Text>
            </XStack>
          </YStack>
        </Card>
      </YStack>
    </YStack>
  );
}

export default SecuritySettings;

