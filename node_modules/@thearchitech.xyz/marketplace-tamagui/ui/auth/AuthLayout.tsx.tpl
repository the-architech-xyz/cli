'use client';

import { ReactNode } from 'react';
import { useAuth } from '@/lib/auth/hooks';
import { useTranslation } from '@/lib/i18n';
import { 
  YStack, 
  XStack, 
  Button, 
  Card, 
  CardContent,
  Text,
  Theme,
  Square
} from 'tamagui';
import { LogOut, User, Settings } from 'lucide-react-native';

interface AuthLayoutProps {
  children: ReactNode;
  title?: string;
  subtitle?: string;
}

export default function AuthLayout({ 
  children, 
  title,
  subtitle
}: AuthLayoutProps) {
  const { t } = useTranslation();
  const { user, logout } = useAuth();
  
  const defaultTitle = t('auth.welcomeBack');
  const defaultSubtitle = t('auth.signInToAccount');

  return (
    <YStack 
      minHeight="100vh" 
      backgroundColor="$backgroundHover"
      backgroundImage="linear-gradient(to bottom right, $blue2, $purple2)"
    >
      <XStack minHeight="100vh">
        {/* Left side - Auth form */}
        <YStack flex={1} alignItems="center" justifyContent="center" paddingHorizontal="$4">
          <YStack maxWidth={400} width="100%" space="$8">
            <YStack alignItems="center">
              <Text fontSize="$6" fontWeight="bold" color="$gray12">
                {title || defaultTitle}
              </Text>
              <Text marginTop="$2" fontSize="$2" color="$gray10">
                {subtitle || defaultSubtitle}
              </Text>
            </YStack>
            
            <Card elevate>
              <CardContent paddingTop="$6">
                {children}
              </CardContent>
            </Card>
          </YStack>
        </YStack>

        {/* Right side - User info (if logged in) */}
        {user && (
          <YStack 
            flex={1} 
            alignItems="center" 
            justifyContent="center"
            display={{ initial: 'none', md: 'flex' }}
          >
            <YStack maxWidth={400} space="$6">
              <YStack alignItems="center">
                <Theme name="accent">
                  <Square 
                    size="$10" 
                    backgroundColor="$background" 
                    borderRadius="$full" 
                    alignItems="center" 
                    justifyContent="center" 
                    marginBottom="$4"
                  >
                    <User size={40} color="$color" />
                  </Square>
                </Theme>
                <Text fontSize="$5" fontWeight="bold" color="$gray12">
                  {t('auth.welcomeBackUser', { name: user.name || user.email })}
                </Text>
                <Text color="$gray10">
                  {t('auth.alreadySignedIn')}
                </Text>
              </YStack>

              <YStack space="$4">
                <Button 
                  onPress={() => window.location.href = '/dashboard'}
                  width="100%"
                  theme="accent"
                >
                  <Text>{t('auth.goToDashboard')}</Text>
                </Button>
                
                <XStack space="$2">
                  <Button 
                    variant="outlined" 
                    onPress={() => window.location.href = '/settings'}
                    flex={1}
                  >
                    <XStack alignItems="center" space="$2">
                      <Settings size={16} />
                      <Text>{t('common.settings')}</Text>
                    </XStack>
                  </Button>
                  <Button 
                    variant="outlined" 
                    onPress={logout}
                    flex={1}
                  >
                    <XStack alignItems="center" space="$2">
                      <LogOut size={16} />
                      <Text>{t('auth.signOut')}</Text>
                    </XStack>
                  </Button>
                </XStack>
              </YStack>
            </YStack>
          </YStack>
        )}
      </XStack>
    </YStack>
  );
}


