'use client';

import { useTranslation } from '@/lib/i18n';
import { CheckCircle, Clock, XCircle, AlertCircle, Loader2 } from 'lucide-react-native';
import { Badge, Text, XStack, AnimatePresence } from 'tamagui';

interface PaymentStatusProps {
  status: 'completed' | 'pending' | 'failed' | 'processing' | 'cancelled' | 'refunded';
  size?: 'sm' | 'md' | 'lg';
  showIcon?: boolean;
}

type StatusConfig = {
  [key: string]: {
    label: string;
    icon: React.ComponentType<{ size?: number; color?: string }>;
    theme: string;
  }
};

const statusConfig: StatusConfig = {
  completed: {
    label: 'Completed',
    icon: CheckCircle,
    theme: 'green'
  },
  pending: {
    label: 'Pending',
    icon: Clock,
    theme: 'yellow'
  },
  processing: {
    label: 'Processing',
    icon: Loader2,
    theme: 'blue'
  },
  failed: {
    label: 'Failed',
    icon: XCircle,
    theme: 'red'
  },
  cancelled: {
    label: 'Cancelled',
    icon: XCircle,
    theme: 'gray'
  },
  refunded: {
    label: 'Refunded',
    icon: AlertCircle,
    theme: 'orange'
  }
};

const sizeConfig = {
  sm: {
    badgeSize: '$1',
    iconSize: 12,
    fontSize: '$1'
  },
  md: {
    badgeSize: '$2',
    iconSize: 16,
    fontSize: '$2'
  },
  lg: {
    badgeSize: '$3',
    iconSize: 20,
    fontSize: '$3'
  }
};

export function PaymentStatus({ 
  status, 
  size = 'md', 
  showIcon = true
}: PaymentStatusProps) {
  const { t } = useTranslation();
  const config = statusConfig[status];
  const sizeStyles = sizeConfig[size];
  const Icon = config.icon;

  return (
    <AnimatePresence>
      <Badge
        variant="outline"
        theme={config.theme}
        size={sizeStyles.badgeSize as any}
        animation="bouncy"
        enterStyle={{ opacity: 0, scale: 0.8 }}
        exitStyle={{ opacity: 0, scale: 0.8 }}
      >
        <XStack alignItems="center" gap="$1.5">
          {showIcon && (
            <Icon 
              size={sizeStyles.iconSize} 
              color={`$${config.theme}10`} 
              {...(status === 'processing' ? { style: { animation: 'spin 1s linear infinite' } } : {})}
            />
          )}
          <Text fontSize={sizeStyles.fontSize} fontWeight="$6">
            {t(`payments.status.${status}`, config.label)}
          </Text>
        </XStack>
      </Badge>
    </AnimatePresence>
  );
}
