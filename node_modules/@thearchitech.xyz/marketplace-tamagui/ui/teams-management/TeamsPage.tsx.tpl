'use client';

import { useState } from 'react';
import { useTranslation } from '@/lib/i18n';
import { 
  Users, 
  Plus, 
  BarChart3, 
  Settings,
  Home
} from 'lucide-react-native';

import {
  YStack,
  XStack,
  Text,
  Tabs,
  TabsContent,
  TabsList,
  TabsTrigger,
  Theme,
  Square
} from 'tamagui';

import { TeamsList } from './TeamsList';
import { CreateTeamForm } from './CreateTeamForm';
import { TeamsDashboard } from './TeamsDashboard';

export default function TeamsPage() {
  const { t } = useTranslation();
  const [showCreateForm, setShowCreateForm] = useState(false);
  const [selectedTeam, setSelectedTeam] = useState(null);

  const handleCreateTeam = () => {
    setShowCreateForm(true);
  };

  const handleTeamCreated = (team: any) => {
    setShowCreateForm(false);
    // Optionally redirect to the new team or refresh the list
  };

  const handleViewTeam = (team: any) => {
    setSelectedTeam(team);
    // Navigate to team detail page or open team modal
  };

  const handleEditTeam = (team: any) => {
    // Open edit team modal or navigate to edit page
    console.log('Edit team:', team);
  };

  const handleDeleteTeam = (team: any) => {
    if (confirm(t('teams.page.confirmDelete', { name: team.name }))) {
      // Handle team deletion
      console.log('Delete team:', team);
    }
  };

  if (showCreateForm) {
    return (
      <YStack padding="$6" maxWidth={640} marginHorizontal="auto">
        <CreateTeamForm
          onSuccess={handleTeamCreated}
          onCancel={() => setShowCreateForm(false)}
        />
      </YStack>
    );
  }

  return (
    <YStack padding="$6" space="$6">
      <YStack space="$2">
        <Text fontSize="$8" fontWeight="$8" color="$color">
          {t('teams.page.title')}
        </Text>
        <Text fontSize="$3" color="$colorFocus">
          {t('teams.page.subtitle')}
        </Text>
      </YStack>

      <Tabs defaultValue="teams">
        <TabsList type="single" flexDirection="row" width="100%">
          <TabsTrigger value="teams" flex={1}>
            <XStack gap="$2" alignItems="center" justifyContent="center">
              <Users size={16} />
              <Text>{t('teams.page.myTeams')}</Text>
            </XStack>
          </TabsTrigger>
          <TabsTrigger value="dashboard" flex={1}>
            <XStack gap="$2" alignItems="center" justifyContent="center">
              <BarChart3 size={16} />
              <Text>{t('teams.page.dashboard')}</Text>
            </XStack>
          </TabsTrigger>
          <TabsTrigger value="settings" flex={1}>
            <XStack gap="$2" alignItems="center" justifyContent="center">
              <Settings size={16} />
              <Text>{t('teams.page.settings')}</Text>
            </XStack>
          </TabsTrigger>
        </TabsList>

        <YStack marginTop="$6">
          <TabsContent value="teams">
            <YStack space="$4">
              <TeamsList
                onCreateTeam={handleCreateTeam}
                onViewTeam={handleViewTeam}
                onEditTeam={handleEditTeam}
                onDeleteTeam={handleDeleteTeam}
              />
            </YStack>
          </TabsContent>

          <TabsContent value="dashboard">
            <YStack space="$4">
              <TeamsDashboard />
            </YStack>
          </TabsContent>

          <TabsContent value="settings">
            <YStack alignItems="center" justifyContent="center" paddingVertical="$12">
              <Settings size={48} color="$colorFocus" />
              <Text fontSize="$5" fontWeight="$6" marginTop="$4" marginBottom="$2">
                {t('teams.page.teamSettings')}
              </Text>
              <Text color="$colorFocus" textAlign="center">
                {t('teams.page.settingsDescription')}
              </Text>
            </YStack>
          </TabsContent>
        </YStack>
      </Tabs>
    </YStack>
  );
}
