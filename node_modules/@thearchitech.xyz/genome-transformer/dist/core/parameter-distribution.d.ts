/**
 * Parameter Distribution System
 *
 * Handles parameter inheritance and distribution from capabilities to modules
 * with validation to ensure modules can handle the parameters being distributed.
 */
import { Module, ProcessedGenome } from './types.js';
import { Logger } from './types.js';
/**
 * Parameter Distribution Rule
 *
 * Defines how parameters from capability configurations are distributed to modules.
 * Supports nested paths (e.g., 'adapter.oauthProviders') and shared parameters.
 */
export interface ParameterDistributionRule {
    capability: string;
    /**
     * Source path using dot notation for nested access
     * Examples:
     * - 'adapter.oauthProviders' -> config.adapter.oauthProviders
     * - 'frontend.features.signIn' -> config.frontend.features.signIn
     * - 'techStack.hasTypes' -> config.techStack.hasTypes
     * - 'shared.emailVerification' -> config.shared.emailVerification
     */
    sourcePath: string;
    /**
     * Target module ID or array of module IDs (for shared parameters)
     * Examples:
     * - 'adapters/auth/better-auth' (single module)
     * - ['adapters/auth/better-auth', 'features/auth/frontend'] (shared across modules)
     */
    targetModule: string | string[];
    /**
     * Target parameter name (can be nested with dot notation)
     * Examples:
     * - 'oauthProviders' -> module.parameters.oauthProviders
     * - 'features.signIn' -> module.parameters.features.signIn
     */
    targetParameter: string;
    transformation?: (value: any) => any;
    validation?: (value: any) => boolean;
    /** @deprecated Use sourcePath instead */
    sourceParameter?: string;
}
export interface ModuleParameterSchema {
    [parameterName: string]: {
        type: 'boolean' | 'string' | 'number' | 'array' | 'object';
        default?: any;
        description?: string;
        required?: boolean;
        options?: any[];
    };
}
export interface ParameterDistributionResult {
    success: boolean;
    modules: Module[];
    errors: string[];
    warnings: string[];
}
export declare class ParameterDistributionService {
    private logger;
    private moduleSchemas;
    private distributionRules;
    constructor(logger: Logger);
    /**
     * Initialize parameter distribution rules for each capability
     *
     * Uses new nested path structure:
     * - adapter.* -> adapter module parameters
     * - frontend.features.* -> frontend module parameters
     * - techStack.* -> tech-stack module parameters
     * - shared.* -> all layers (adapter, frontend, tech-stack)
     */
    private initializeDistributionRules;
    /**
     * Load module parameter schemas from marketplace
     */
    loadModuleSchemas(marketplacePath: string): Promise<void>;
    /**
     * Load schemas from a directory recursively
     */
    private loadSchemasFromDirectory;
    /**
     * Load schema from a single file
     */
    private loadSchemaFromFile;
    /**
     * Distribute capability parameters to modules
     */
    distributeParameters(genome: ProcessedGenome, marketplacePath: string): Promise<ParameterDistributionResult>;
    /**
     * Deduplicate modules by ID, keeping only the first occurrence
     */
    private deduplicateModules;
    /**
     * Distribute parameters for a single capability
     */
    private distributeCapabilityParameters;
    /**
     * Get nested value from object using dot notation
     * Examples:
     * - getNestedValue({a: {b: 1}}, 'a.b') -> 1
     * - getNestedValue({adapter: {oauth: ['google']}}, 'adapter.oauth') -> ['google']
     */
    private getNestedValue;
    /**
     * Set nested value in object using dot notation
     * Creates intermediate objects as needed
     * Examples:
     * - setNestedValue({}, 'features.signIn', true) -> {features: {signIn: true}}
     * - setNestedValue({}, 'oauthProviders', ['google']) -> {oauthProviders: ['google']}
     */
    private setNestedValue;
    /**
     * Check if a module can handle a specific parameter
     */
    private canModuleHandleParameter;
    /**
     * Get the type of a value
     */
    private getTypeOfValue;
    /**
     * Validate all module parameters
     */
    private validateModuleParameters;
}
//# sourceMappingURL=parameter-distribution.d.ts.map